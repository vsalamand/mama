<% if @list_item.errors.any? %>
  refreshForm('<%= j render "list_items/form", list: @list, list_item: @list_item %>');
<% else %>
  refreshList();
  refreshForm('<%= j render "list_items/form", list: @list, list_item: ListItem.new %>');
<% end %>


function refreshForm(innerHTML) {
  const newListItemForm = document.getElementById('new_list_item');
  newListItemForm.innerHTML = innerHTML;
  var submitButton = document.getElementById('addListItemBtn');
  $(submitButton).prop('disabled', true);
  event.preventDefault();
}

function refreshList() {
  // reload content in grocerylist
  const uncompleteListItems = document.getElementById('uncomplete_list_items');
  uncompleteListItems.innerHTML = "";
  uncompleteListItems.innerHTML = ("<%= j render 'lists/uncomplete_todo_list', list: @list %>");
}


const current_user_id = "<%= user_signed_in? ? current_user.id : nil %>";
getEditHistory(current_user_id);

function getEditHistory(current_user_id) {
  const listId = document.querySelector("#todo_list").getAttribute('data');

  $.ajax({
    url: "/lists/" + listId + "/get_edit_history",
    cache: false,
    data: {
      a: current_user_id
      },
    success: function(data){
    }
  });
}
