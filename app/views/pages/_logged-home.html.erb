<div class="banner d-flex flex-column" style="background-image: linear-gradient(rgba(0,0,0,0.2),rgba(0,0,0,0.1)), url(<%= cl_image_path("home_photos/hp#{Date.today.strftime("%d").to_i}-min", crop: :scale, :quality=>"auto:low", :width => :auto, :responsive_placeholder => "blank", :fetch_format=>:auto) %>);">

  <%= render 'shared/navbar_white' %>

  <div class="container">
    <%= render 'shared/flashes' %>
  </div>


  <div class="container my-auto d-flex flex-column justify-content-start align-items-center">

    <% if @lists.any? %>
      <%= link_to 'Mes courses', list_path(@lists.last), class:"btn btn-lg bg-transparent text-white border px-5 py-3 font-weight-bold", style:"font-size: 2rem;" %>
    <% else %>
      <%= simple_form_for @list do |f| %>
        <%= f.input :name, :autofocus => true, label: false, :as => :hidden, placeholder: "Donnez un nom à votre liste", input_html: { class:"my-3 rounded-0 autofocus", value: "Liste de courses" } %>
        <%= f.input :user_id, input_html: {value: current_user.id}, :as => :hidden, :wrapper_html=> { class: "m-0" }  %>
        <%= f.input :status, input_html: {value: "saved"}, :as => :hidden, :wrapper_html=> { class: "m-0" }  %>
        <%= f.submit "Créer une première liste en quelques clics", class:"btn btn-lg bg-transparent text-white border p-3 font-weight-bold", style:"font-size: 2rem; margin-bottom:4px;white-space: normal;" %>
      <% end %>
    <% end %>

  </div>


  <%= link_to "Mon compte", profile_path, class:"nav-link text-white text-center"  %>

</div>


<%= render "lists/new_list_modal", list: @list, recipe_list: @recipe_list %>

  <!-- Lists Modal -->
  <div class="modal fade" id="listsModal" tabindex="-1" role="dialog" aria-labelledby="listsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable" role="document">
      <div class="modal-content bg-white">
        <div class="modal-header">
          <h5 class="modal-title" id="listsModalLabel">📝 Listes de courses</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="card-body">
          <h5 class="btn btn-block btn-flat rounded" style="cursor: pointer;" data-toggle="modal" data-target="#createListModal" id="openCreateModal">✏️ Nouvelle liste</h5>
        </div>
        <div class="modal-body m-0 p-0" style="height: 60vh; overflow-y: auto;">
          <%= render 'lists/index', lists: @lists %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Recipe Lists Modal -->
  <div class="modal fade" id="recipeListsModal" tabindex="-1" role="dialog" aria-labelledby="recipeListsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable" role="document">
      <div class="modal-content bg-white">
        <div class="modal-header">
          <h5 class="modal-title" id="recipeListsModalLabel">🍔 Menus enregistrés</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="card-body">
          <h5 class="btn btn-block btn-flat rounded" style="cursor: pointer;" data-toggle="modal" data-target="#createRecipeListModal" id="openCreateModal">✏️ Nouveau menu</h5>
        </div>
        <div class="modal-body m-0 p-0" style="height: 60vh; overflow-y: auto;">
          <%= render 'recipe_lists/index', recipe_lists: @recipe_lists %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
        </div>
      </div>
    </div>
  </div>



  <!-- Carts Modal -->
  <div class="modal fade" id="cartsModal" tabindex="-1" role="dialog" aria-labelledby="cartsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable" role="document">
      <div class="modal-content bg-white">
        <div class="modal-header">
          <h5 class="modal-title" id="cartsModalLabel">🛒 Historique d'achats</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body m-0 p-0" style="height: 75vh;overflow-y: auto;">
          <%= render 'carts/index', carts: @carts %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
        </div>
      </div>
    </div>
  </div>



