<div class="container mt-5">
  <div class="d-flex flex-column mb-3">
    <h1 class="font-weight-bold mb-0">Panier de courses chez <strong class="btn-outline-primary"><%= @cart.merchant.name %></strong> </h1>
    <small class="text-muted p-0 pt-1">Cliquez sur un produit pour le changer.</small>
  </div>
  <div class="d-flex flex-wrap">
    <!-- dropdown button -->
    <div class="btn-group">
      <button type="button" class="m-1 btn btn-outline-secondary rounded" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Options</button>
      <div class="dropdown-menu dropdown-menu-right">
        <a class="dropdown-item btn" data-toggle="modal" data-target="#shareModal">Envoyer par email</a>
        <% if current_user.present? && current_user.admin == true %>
          <a class="dropdown-item btn" data-toggle="modal" data-target="#adminShareModal">Magic share</a>
        <% end %>
        <% if @cart.user == current_user %>
          <!-- Button trigger Create List modal -->
          <div class="dropdown-divider"></div>
            <%= link_to "Supprimer", cart_path(@cart), method: :delete,  data: { confirm: 'Êtes-vous sûr ?' }, class:"dropdown-item text-danger" %>
        <% end %>
       </div>
    </div>
  </div>

</div>

  <!-- Share Modal -->
    <div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="shareModalLabel">Envoyer par email</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <%= form_tag(cart_share_path(@cart), class: 'form-group') do |f| %>
            <div class="modal-body">
              <%= text_field_tag 'email', '', value: "#{current_user.present? ? current_user.email : ''}", type: "email", class:"form-control" %>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Annuler</button>
              <%= submit_tag "submit",:value => "Envoyer", class:"btn btn-primary"%>
            </div>
          <% end %>
        </div>
      </div>
    </div>

  <!-- Admin Modal -->
    <div class="modal fade" id="adminShareModal" tabindex="-1" role="dialog" aria-labelledby="adminShareModal" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="adminShareModal">Envoyer par email</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <%= form_tag(cart_special_share_path(@cart), class: 'form-group') do |f| %>
            <div class="modal-body">
              <%= text_field_tag 'email', '', value: "#{current_user.present? ? current_user.email : ''}", type: "email", class:"form-control" %>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Annuler</button>
              <%= submit_tag "submit",:value => "Envoyer", class:"btn btn-primary"%>
            </div>
          <% end %>
        </div>
      </div>
    </div>

<hr class="my-4">

<div class="container" id="cart-content" data="<%= @cart.id %>">
  <%= render 'cart_content', cart: @cart %>
</div>

<div style="padding: 50px;"></div>

<!-- Button trigger Select Order modal -->
<a class="btn fixed-bottom btn-flat2 py-3 font-weight-bold mt-5" data-toggle="modal" data-target="#orderModal">Valider le panier | <%= @cart.get_total_price %>€ </a>

<!-- Select Order Modal -->
<div class="modal fade" id="orderModal" tabindex="-1" role="dialog" aria-labelledby="orderModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content bg-white">
      <div class="modal-header">
        <h5 class="modal-title" id="orderModalLabel">Faites vos achats</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body m-0 p-0">
      </div>
    </div>
  </div>
</div>
